#! /bin/bash

set -x


#   (force) Add plasma config to use latte in wayland

xdg_skel_path="/etc/skel/.config"
xdg_user_path="$HOME/.config"

if [ -f "$HOME/.latte-wayland-check" ]
    then
        exit 0
    else
    rm "$xdg_user_path/plasma-org.kde.plasma.desktop-appletsrc"
    $(which cp) "$xdg_skel_path/plasma-org.kde.plasma.desktop-appletsrc" "$xdg_user_path"
    $(which cp) "$xdg_skel_path/plasmashellrc" "$xdg_user_path"
    touch "$HOME/.latte-wayland-check"

sleep 1

    if pgrep -x "plasmashell" > /dev/null
        then
            plasmashell --replace &
    fi

fi

exit 0
